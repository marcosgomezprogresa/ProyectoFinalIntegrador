<div class="row">
  <div class="col-md-3">
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">Filtros</h5>
        <div class="mb-3">
          <label class="form-label">Categor√≠a</label>
          <div class="input-group">
            <select class="form-select" [(ngModel)]="categoriaSeleccionada">
              <option value="">Todas</option>
              <option value="entrante">Entrante</option>
              <option value="principal">Principal</option>
              <option value="postre">Postre</option>
              <option value="bebida">Bebida</option>
              <option value="refrigerio">Refrigerio</option>
            </select>
            <button class="btn btn-outline-primary" type="button" (click)="alCambiarCategoria()" title="Buscar">
              üîç
            </button>
          </div>
        </div>
        <button class="btn btn-warning w-100 mb-2" (click)="obtenerRecetasVeganas()">
          üå± Veganas
        </button>
        <button class="btn btn-info w-100" (click)="cargarRecetas()">
          Todas
        </button>
      </div>
    </div>

    <div class="card mt-3">
      <div class="card-body">
        <h5 class="card-title">Crear Receta</h5>
        <button class="btn btn-success w-100" (click)="abrirFormularioModal()">
          + Nueva Receta
        </button>
      </div>
    </div>
  </div>

  <div class="col-md-9">
    <!-- Cargando -->
    <div *ngIf="cargando" class="text-center">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Cargando...</span>
      </div>
    </div>

    <!-- Alerta Error -->
    <div *ngIf="mensajeError" class="alert alert-danger alert-dismissible fade show" role="alert">
      {{ mensajeError }}
      <button type="button" class="btn-close" (click)="mensajeError = null"></button>
    </div>

    <!-- Alerta √âxito -->
    <div *ngIf="mensajeExito" class="alert alert-success alert-dismissible fade show" role="alert">
      {{ mensajeExito }}
      <button type="button" class="btn-close" (click)="mensajeExito = null"></button>
    </div>

    <!-- Tabla Recetas -->
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">Recetas ({{paginacion.total}} total)</h5>
        <div class="table-responsive">
          <table class="table table-hover">
            <thead>
              <tr>
                <th>T√≠tulo</th>
                <th>Categor√≠a</th>
                <th>Tiempo (min)</th>
                <th>Dificultad</th>
                <th>Rating</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let receta of recetas">
                <td>{{ receta.title }}</td>
                <td>
                  <span class="badge" [ngClass]="obtenerClaseBadgeCategoria(receta.category)">
                    {{ obtenerEtiquetaCategoria(receta.category) }}
                  </span>
                </td>
                <td>{{ receta.preparationTime }}</td>
                <td>
                  <span class="badge" [ngClass]="obtenerClaseBadgeDificultad(receta.difficulty)">
                    {{ obtenerEtiquetaDificultad(receta.difficulty) }}
                  </span>
                </td>
                <td>‚≠ê {{ receta.rating }}</td>
                <td>
                  <button class="btn btn-sm btn-primary" (click)="verReceta(receta)">Ver</button>
                  <button class="btn btn-sm btn-warning ms-1" (click)="editarReceta(receta)">Editar</button>
                  <button class="btn btn-sm btn-danger ms-1" (click)="eliminarReceta(receta._id!)">Eliminar</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Paginaci√≥n -->
        <nav>
          <ul class="pagination justify-content-center">
            <li class="page-item" [class.disabled]="paginacion.page <= 1">
              <button class="page-link" (click)="irAPagina(paginacion.page - 1)" [disabled]="paginacion.page <= 1">
                Anterior
              </button>
            </li>
            <li class="page-item active">
              <span class="page-link">P√°gina {{ paginacion.page }} de {{ paginacion.pages }}</span>
            </li>
            <li class="page-item" [class.disabled]="paginacion.page >= paginacion.pages">
              <button class="page-link" (click)="irAPagina(paginacion.page + 1)" [disabled]="paginacion.page >= paginacion.pages">
                Siguiente
              </button>
            </li>
          </ul>
        </nav>
      </div>
    </div>
  </div>
</div>

<!-- Modal Detalle -->
<div class="modal fade" id="detalleModal" tabindex="-1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Detalles de Receta</h5>
        <button type="button" class="btn-close" (click)="cerrarDetalleModal()"></button>
      </div>
      <div class="modal-body">
        <app-detalle-receta *ngIf="recetaSeleccionada" [receta]="recetaSeleccionada"></app-detalle-receta>
      </div>
    </div>
  </div>
</div>

<!-- Modal Formulario -->
<div class="modal fade" id="formularioModal" tabindex="-1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">{{ recetaEditando ? 'Editar Receta' : 'Nueva Receta' }}</h5>
        <button type="button" class="btn-close" (click)="cerrarFormularioModal()"></button>
      </div>
      <div class="modal-body">
        <app-formulario-receta 
          [receta]="recetaEditando" 
          (guardada)="alRecetaGuardada($event)"
          (cerrada)="cerrarFormularioModal()">
        </app-formulario-receta>
      </div>
    </div>
  </div>
</div>
